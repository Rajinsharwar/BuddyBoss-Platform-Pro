window.bp=window.bp||{},function(i){bp.Zoom_Common={start:function(){this.setupGlobals(),this.addListeners()},setupGlobals:function(){},addListeners:function(){i(document).on("click","#bp-zoom-check-connection, #bp-zoom-group-check-connection",this.checkConnection.bind(this)),i(document).on("change","#bp-zoom-api-key, #bp-zoom-api-secret, #bp-zoom-api-email, #bp-group-zoom-api-key, #bp-group-zoom-api-secret, #bp-group-zoom-api-email",this.checkApiFields.bind(this)),i(document).on("change","#bp-edit-group-zoom",this.toggleGroupSettings.bind(this)),i(document).on("click",".copy-webhook-link",this.copyWebhookLink.bind(this)),i(document).on("click",".bp-step-nav li > a, .bp-step-actions > span",this.bpStepsNavigate.bind(this)),i(document).on("keyup",".zoom-group-instructions-cloned-input",this.copyInputData.bind(this)),i(document).on("keyup",".zoom-group-instructions-main-input",this.copyMainInputData.bind(this)),i(document).on("click",".bp-zoom-group-show-instructions .save-settings",this.zoomInstructionSave.bind(this)),i(window).on("keyup",this.zoomInstructionNavigate.bind(this)),i(document).find(".bb-group-zoom-settings-container").length&&i(document).on("click","form#group-settings-form button.bb-save-settings",this.zoomSettingsSave.bind(this)),void 0!==jQuery.fn.magnificPopup&&jQuery(".show-zoom-instructions").magnificPopup({type:"inline",midClick:!0})},copyWebhookLink:function(o){var e=i(o.currentTarget),t=e.attr("data-balloon");if(e.closest(".bp-zoom-group-show-instructions").length&&(t=e.attr("data-text")),e.hasClass("copied"))return!1;o.preventDefault();var n=document.createElement("textarea");n.value=e.data("webhook-link"),e.closest(".bp-zoom-group-show-instructions").length?e.closest(".bp-zoom-group-show-instructions")[0].appendChild(n):document.body.appendChild(n),n.select();try{document.execCommand("copy")&&(e.addClass("copied"),e.closest(".bp-zoom-group-show-instructions").length?e.html('<span class="bb-icon-l bb-icon-check"></span> '+e.data("copied")):e.attr("data-balloon",e.data("copied")),setTimeout(function(){e.removeClass("copied")},2e3),setTimeout(function(){e.closest(".bp-zoom-group-show-instructions").length?e.html('<span class="bb-icon-l bb-icon-duplicate"></span> '+t):e.attr("data-balloon",t)},3e3))}catch(o){console.log("Oops, unable to copy")}e.closest(".bp-zoom-group-show-instructions").length?e.closest(".bp-zoom-group-show-instructions")[0].removeChild(n):document.body.removeChild(n)},checkApiFields:function(o){var e=i("#bp-zoom-api-key").length?i("#bp-zoom-api-key").val():i("#bp-group-zoom-api-key").length?i("#bp-group-zoom-api-key").val():"",t=i("#bp-zoom-api-secret").length?i("#bp-zoom-api-secret").val():i("#bp-group-zoom-api-secret").length?i("#bp-group-zoom-api-secret").val():"",n=i("#bp-zoom-api-email").length?i("#bp-zoom-api-email").val():i("#bp-group-zoom-api-email").length?i("#bp-group-zoom-api-email").val():"";o.preventDefault(),""===e||""===t||""===n?jQuery("#bp-zoom-check-connection, #bp-zoom-group-check-connection").hide():jQuery("#bp-zoom-check-connection, #bp-zoom-group-check-connection").show()},checkConnection:function(o){var e=i("#bp-zoom-api-key").length?i("#bp-zoom-api-key").val():i("#bp-group-zoom-api-key").length?i("#bp-group-zoom-api-key").val():"",t=i("#bp-zoom-api-secret").length?i("#bp-zoom-api-secret").val():i("#bp-group-zoom-api-secret").length?i("#bp-group-zoom-api-secret").val():"",n=i("#bp-zoom-api-email").length?i("#bp-zoom-api-email").val():i("#bp-group-zoom-api-email").length?i("#bp-group-zoom-api-email").val():"";if(o.preventDefault(),""===e||""===t||""===n)return!1;i(document).find("#bp-zoom-group-check-connection").addClass("loading"),i.ajax({type:"GET",url:bpZoomMeetingCommonVars.ajax_url,data:{action:"zoom_api_check_connection",key:e,secret:t,email:n},success:function(o){void 0!==o.data&&o.data.message&&(alert(o.data.message),i(document).find("#bp-zoom-group-check-connection").removeClass("loading"))}})},toggleGroupSettings:function(o){var e=i(o.target),t=e.closest("form").find("#bp-group-zoom-settings");o.preventDefault(),e.is(":checked")?(i("#bp-group-zoom-settings, #bp-zoom-group-show-instructions").removeClass("bp-hide"),i("#bp-group-zoom-settings-additional").removeClass("bp-hide"),i("#bp-zoom-check-connection, #bp-zoom-group-check-connection").show(),t.find("#bp-group-zoom-api-key, #bp-group-zoom-api-secret, #bp-group-zoom-api-email").attr("required",!0)):(i("#bp-group-zoom-settings, #bp-zoom-group-show-instructions").addClass("bp-hide"),i("#bp-group-zoom-settings-additional").addClass("bp-hide"),i("#bp-zoom-check-connection, #bp-zoom-group-check-connection").hide(),t.find("#bp-group-zoom-api-key, #bp-group-zoom-api-secret, #bp-group-zoom-api-email").removeAttr("required"))},bpStepsNavigate:function(o){o.preventDefault();var e,t,n=i(o.currentTarget);n.closest(".bp-step-nav").length?(n.closest("li").addClass("selected").siblings().removeClass("selected"),n.closest(".bp-step-nav-main").find(".bp-step-block"+n.attr("href")).addClass("selected").siblings().removeClass("selected")):n.closest(".bp-step-actions").length&&(e=n.closest(".bp-step-nav-main").find(".bp-step-block.selected"),t=n.closest(".bp-step-nav-main").find(".bp-step-nav li.selected"),n.hasClass("bp-step-prev")?(e.removeClass("selected").prev().addClass("selected"),t.removeClass("selected").prev().addClass("selected")):n.hasClass("bp-step-next")&&(e.removeClass("selected").next().addClass("selected"),t.removeClass("selected").next().addClass("selected")));var s=n.closest(".bp-step-nav-main").find(".bp-step-nav li").length;0==n.closest(".bp-step-nav-main").find(".bp-step-nav li.selected").index()?n.closest(".bp-step-nav-main").find(".bp-step-actions .bp-step-prev").hide():n.closest(".bp-step-nav-main").find(".bp-step-actions .bp-step-prev").show(),n.closest(".bp-step-nav-main").find(".bp-step-nav li.selected").index()==s-1?n.closest(".bp-step-nav-main").addClass("last-tab").find(".bp-step-actions .bp-step-next").hide():n.closest(".bp-step-nav-main").removeClass("last-tab").find(".bp-step-actions .bp-step-next").show()},copyInputData:function(o){i(document).find("input[name="+i(o.currentTarget).attr("name").replace("-popup","")+"]").val(i(o.currentTarget).val())},copyMainInputData:function(o){i(document).find("input[name="+i(o.currentTarget).attr("name")+"-popup]").val(i(o.currentTarget).val())},zoomSettingsSave:function(o){""!==i(o.target).closest("form").find("#bp-group-zoom-api-key").val().trim()&&""!==i(o.target).closest("form").find("#bp-group-zoom-api-secret").val().trim()&&""!==i(o.target).closest("form").find("#bp-group-zoom-api-email").val().trim()&&i(o.target).addClass("loading")},zoomInstructionSave:function(){void 0!==jQuery.fn.magnificPopup&&i.magnificPopup.close(),i(document).find("#group-settings-form button.bb-save-settings").trigger("click")},zoomInstructionNavigate:function(o){i(".bp-zoom-group-show-instructions").length&&(39==o.keyCode?i(".bp-zoom-group-show-instructions .bp-step-actions .bp-step-next:visible").trigger("click"):37==o.keyCode&&i(".bp-zoom-group-show-instructions .bp-step-actions .bp-step-prev:visible").trigger("click"))}},bp.Zoom_Common.start()}((bp,jQuery));